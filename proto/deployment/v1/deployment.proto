syntax = "proto3";

package deployment.v1;

option go_package = "github.com/theleeeo/overseer/api-go/deployment/v1;deployment";

import "google/protobuf/timestamp.proto";

message Deployment {
  int32 instance_id = 1;
  string version = 2;
  google.protobuf.Timestamp deployed_at = 3;
}

service DeploymentService {
  // rpc Get(GetRequest) returns (GetResponse);

  rpc Register(RegisterRequest) returns (RegisterResponse);

  rpc List(ListRequest) returns (ListResponse);
}

message ResponsePagination { int32 total = 1; }

// message GetRequest {
//   int32 environment_id = 1;
//   int32 application_id = 2;
// }

// message GetResponse { Deployment deployment = 1; }

message RegisterRequest {
  // TODO: Instance Selector? Allowing it to be selected using name, id or
  // env-app combo.
  int32 instance_id = 1;
  string version = 2;
  google.protobuf.Timestamp deployed_at = 3;
}

message RegisterResponse {}

message ListRequest {
  // TODO: InstanceSelector
  // int32 instance_id = 1;
}

message ListResponse {
  repeated Deployment deployments = 1;
  ResponsePagination pagination = 2;
}
